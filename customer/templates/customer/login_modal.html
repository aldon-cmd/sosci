{% load widget_tweaks %}
<div class="modal-dialog modal-box" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel"></h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
      <form id="login-form" method="post" action="{% url 'customer:login-modal' view.kwargs.course_id %}" novalidate>
        {% csrf_token %} {{ form.non_field_errors }}
        <div ng-class="{'has-error':vm.form.email.$invalid}" class="col-md-12 payroll-setup-taxpayer-information-item extra-non-padding grid-col-form grid-col-width grid-col-top remove-padding n1">
          <div class="input-select_select">
            {{ form.username }} {{ form.username.errors }}
          </div>
        </div>
        <div ng-class="{'has-error':vm.form.password.$invalid}" class="col-md-12 payroll-setup-taxpayer-information-item extra-non-padding grid-col-form grid-col-width">
          <div class="input-select_select">
            {{ form.password }} {{ form.password.errors }}
          </div>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 d-flex option-box">
          <span class="signup-today">
             <a href="{% url 'customer:password_reset' %}">Forgot Your Password?</a>
          </span>
        </div>
        <div id="save-btn">
          <button type="submit" ng-click="vm.submit(vm.form_data)" class=" enroll-btn btn btn-color btn-xtra-large btn-block panel-btn">Submit</button>
          <div class="login-footer">
            <span class="signup-today hide">
               <a href="{% url 'customer:resend-email-confirmation' %}">Resend Confirmation Email?</a>
            </span>
            <span class="signup-today">
              <span>If you do not have an account</span>
               <a class="open-registration-modal" href="{% url 'customer:registration-modal' view.kwargs.course_id %}">Sign up here</a>
            </span>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer"></div>
  </div>
</div>


  <script>

  $('#login-form')
    .ajaxForm({
      target: '#authentication-modal',
      success : get_success_response,
      error: get_error_response       
    });

    function get_success_response(responseText, statusText, xhr, $form){

              window.location.replace("{% url 'checkout:payment-details' view.kwargs.course_id %}");
          }

              function get_error_response(data){

              $("#authentication-modal").html(data.responseText);
          }

           
</script>

<script>
  $(document).on('click',".open-registration-modal", function (event) {
    event.preventDefault();
    open_registration_modal($(this).attr('href'));

    
  });

function open_registration_modal(url){

    $('#authentication-modal').load(url,function(){

        $('#authentication-modal').modal('show');
        
        
    });

    
}

</script>
